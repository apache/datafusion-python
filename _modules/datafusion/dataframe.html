<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>datafusion.dataframe &#8212; Apache Arrow DataFusion  documentation</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css?v=1140d252" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=ef9fea58" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script src="../../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items">
<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/images/2x_bgwhite_original.png" class="logo" alt="logo">
</a>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LINKS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion-python">
   Github and Issue Tracker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.rs/datafusion/latest/datafusion/">
   Rust's API Docs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion/blob/main/CODE_OF_CONDUCT.md">
   Code of conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/apache/datafusion-python/tree/main/examples">
   Examples
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  USER GUIDE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/basics.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/configuration.html">
   Configuration
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../user-guide/common-operations/index.html">
   Common Operations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/basic-info.html">
     Basic Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/select-and-filter.html">
     Column Selections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/expressions.html">
     Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/joins.html">
     Joins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/functions.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/aggregations.html">
     Aggregation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/windows.html">
     Window Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/common-operations/udf-and-udfa.html">
     User Defined Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../user-guide/io/index.html">
   IO
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/io/csv.html">
     CSV
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/io/parquet.html">
     Parquet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/io/json.html">
     JSON
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../user-guide/io/avro.html">
     Avro
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../user-guide/sql.html">
   SQL
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CONTRIBUTOR GUIDE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributor-guide/introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../api.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../api/dataframe.html">
     DataFrame
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.DataFrame.html">
       datafusion.DataFrame
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../api/execution_context.html">
     SessionContext
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.SessionConfig.html">
       datafusion.SessionConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.RuntimeConfig.html">
       datafusion.RuntimeConfig
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.SessionContext.html">
       datafusion.SessionContext
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../api/expression.html">
     Expr
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.Expr.html">
       datafusion.Expr
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../api/functions.html">
     Functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.functions.html">
       datafusion.functions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../api/object_store.html">
     ObjectStore
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../generated/datafusion.object_store.object_store.html">
       datafusion.object_store.object_store
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for datafusion.dataframe</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed to the Apache Software Foundation (ASF) under one</span>
<span class="c1"># or more contributor license agreements.  See the NOTICE file</span>
<span class="c1"># distributed with this work for additional information</span>
<span class="c1"># regarding copyright ownership.  The ASF licenses this file</span>
<span class="c1"># to you under the Apache License, Version 2.0 (the</span>
<span class="c1"># &quot;License&quot;); you may not use this file except in compliance</span>
<span class="c1"># with the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#   http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing,</span>
<span class="c1"># software distributed under the License is distributed on an</span>
<span class="c1"># &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span>
<span class="c1"># KIND, either express or implied.  See the License for the</span>
<span class="c1"># specific language governing permissions and limitations</span>
<span class="c1"># under the License.</span>
<span class="sd">&quot;&quot;&quot;DataFrame is one of the core concepts in DataFusion.</span>

<span class="sd">See https://datafusion.apache.org/python/user-guide/basics.html for more</span>
<span class="sd">information.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TYPE_CHECKING</span>
<span class="kn">from</span> <span class="nn">datafusion.record_batch</span> <span class="kn">import</span> <span class="n">RecordBatchStream</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">deprecated</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
    <span class="kn">import</span> <span class="nn">pathlib</span>

<span class="kn">from</span> <span class="nn">datafusion._internal</span> <span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">DataFrameInternal</span>
<span class="kn">from</span> <span class="nn">datafusion.expr</span> <span class="kn">import</span> <span class="n">Expr</span>
<span class="kn">from</span> <span class="nn">datafusion._internal</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LogicalPlan</span><span class="p">,</span>
    <span class="n">ExecutionPlan</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="DataFrame">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame">[docs]</a>
<span class="k">class</span> <span class="nc">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Two dimensional table representation of data.</span>

<span class="sd">    See https://datafusion.apache.org/python/user-guide/basics.html for more</span>
<span class="sd">    information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataFrame.__init__">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">DataFrameInternal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This constructor is not to be used by the end user.</span>

<span class="sd">        See ``SessionContext`` for methods to create DataFrames.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new `DataFrame` with the specified column or columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            key: Column name or list of column names to select.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with the specified column or columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the DataFrame.</span>

<span class="sd">        Returns:</span>
<span class="sd">            String representation of the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

<div class="viewcode-block" id="DataFrame.describe">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.describe">[docs]</a>
    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new `DataFrame` that has statistics for a DataFrame.</span>

<span class="sd">        Only summarized numeric datatypes at the moments and returns nulls</span>
<span class="sd">        for non-numeric datatypes.</span>

<span class="sd">        The output format is modeled after pandas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A summary DataFrame containing statistics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span></div>


<div class="viewcode-block" id="DataFrame.schema">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.schema">[docs]</a>
    <span class="k">def</span> <span class="nf">schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Schema</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the `pyarrow.Schema` describing the output of this DataFrame.</span>

<span class="sd">        The output schema contains information on the name, data type, and</span>
<span class="sd">        nullability for each column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Describing schema of the DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.select_columns">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.select_columns">[docs]</a>
    <span class="k">def</span> <span class="nf">select_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the DataFrame by columns.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame only containing the specified columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.select">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.select">[docs]</a>
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">Expr</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project arbitrary expressions into a new `DataFrame`.</span>

<span class="sd">        Args:</span>
<span class="sd">            exprs: Either column names or `Expr` to select.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after projection. It has one column for each expression.</span>

<span class="sd">        Example usage:</span>

<span class="sd">        The following example will return 3 columns from the original dataframe.</span>
<span class="sd">        The first two columns will be the original column `a` and `b` since the</span>
<span class="sd">        string &quot;a&quot; is assumed to refer to column selection. Also a duplicate of</span>
<span class="sd">        column `a` will be returned with the column name `alternate_a`::</span>

<span class="sd">            df = df.select(&quot;a&quot;, col(&quot;b&quot;), col(&quot;a&quot;).alias(&quot;alternate_a&quot;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">arg</span><span class="o">.</span><span class="n">expr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Expr</span><span class="p">)</span> <span class="k">else</span> <span class="n">Expr</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">exprs</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.filter">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.filter">[docs]</a>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">predicates</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a DataFrame for which `predicate` evaluates to `True`.</span>

<span class="sd">        Rows for which `predicate` evaluates to `False` or `None` are filtered</span>
<span class="sd">        out.  If more than one predicate is provided, these predicates will be</span>
<span class="sd">        combined as a logical AND. If more complex logic is required, see the</span>
<span class="sd">        logical operations in `datafusion.functions`.</span>

<span class="sd">        Args:</span>
<span class="sd">            predicates: Predicate expression(s) to filter the DataFrame.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">predicates</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.with_column">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.with_column">[docs]</a>
    <span class="k">def</span> <span class="nf">with_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an additional column to the DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the column to add.</span>
<span class="sd">            expr: Expression to compute the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with the new column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">expr</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.with_column_renamed">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.with_column_renamed">[docs]</a>
    <span class="k">def</span> <span class="nf">with_column_renamed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rename one column by applying a new projection.</span>

<span class="sd">        This is a no-op if the column to be renamed does not exist.</span>

<span class="sd">        The method supports case sensitive rename with wrapping column name</span>
<span class="sd">        into one the following symbols (&quot; or &#39; or `).</span>

<span class="sd">        Args:</span>
<span class="sd">            old_name: Old column name.</span>
<span class="sd">            new_name: New column name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with the column renamed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">with_column_renamed</span><span class="p">(</span><span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.aggregate">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.aggregate">[docs]</a>
    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_by</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Expr</span><span class="p">],</span> <span class="n">aggs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Expr</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregates the rows of the current DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_by: List of expressions to group by.</span>
<span class="sd">            aggs: List of expressions to aggregate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after aggregation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_by</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">expr</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">group_by</span><span class="p">]</span>
        <span class="n">aggs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">expr</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">aggs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">group_by</span><span class="p">,</span> <span class="n">aggs</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.sort">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.sort">[docs]</a>
    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the DataFrame by the specified sorting expressions.</span>

<span class="sd">        Note that any expression can be turned into a sort expression by</span>
<span class="sd">        calling its `sort`  method.</span>

<span class="sd">        Args:</span>
<span class="sd">            exprs: Sort expressions, applied in order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after sorting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">expr</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">exprs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.limit">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.limit">[docs]</a>
    <span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new `DataFrame` with a limited number of rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            count: Number of rows to limit the DataFrame to.</span>
<span class="sd">            offset: Number of rows to skip.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after limiting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.collect">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.collect">[docs]</a>
    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute this `DataFrame` and collect results into memory.</span>

<span class="sd">        Prior to calling `collect`, modifying a DataFrme simply updates a plan</span>
<span class="sd">        (no actual computation is performed). Calling `collect` triggers the</span>
<span class="sd">        computation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of `pyarrow.RecordBatch`es collected from the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.cache">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.cache">[docs]</a>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cache the DataFrame as a memory table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Cached DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">cache</span><span class="p">())</span></div>


<div class="viewcode-block" id="DataFrame.collect_partitioned">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.collect_partitioned">[docs]</a>
    <span class="k">def</span> <span class="nf">collect_partitioned</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute this DataFrame and collect all partitioned results.</span>

<span class="sd">        This operation returns ``RecordBatch`` maintaining the input</span>
<span class="sd">        partitioning.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of list of ``RecordBatch`` collected from the</span>
<span class="sd">                DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">collect_partitioned</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.show">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.show">[docs]</a>
    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the DataFrame and print the result to the console.</span>

<span class="sd">        Args:</span>
<span class="sd">            num: Number of lines to show.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.distinct">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.distinct">[docs]</a>
    <span class="k">def</span> <span class="nf">distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new `DataFrame` with all duplicated rows removed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after removing duplicates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">distinct</span><span class="p">())</span></div>


<div class="viewcode-block" id="DataFrame.join">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.join">[docs]</a>
    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">right</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">join_keys</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">how</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Join this `DataFrame` with another `DataFrame`.</span>

<span class="sd">        Join keys are a pair of lists of column names in the left and right</span>
<span class="sd">        dataframes, respectively. These lists must have the same length.</span>

<span class="sd">        Args:</span>
<span class="sd">            right: Other DataFrame to join with.</span>
<span class="sd">            join_keys: Tuple of two lists of column names to join on.</span>
<span class="sd">            how: Type of join to perform. Supported types are &quot;inner&quot;, &quot;left&quot;,</span>
<span class="sd">                &quot;right&quot;, &quot;full&quot;, &quot;semi&quot;, &quot;anti&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after join.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">join_keys</span><span class="p">,</span> <span class="n">how</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.explain">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.explain">[docs]</a>
    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">analyze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a DataFrame with the explanation of its plan so far.</span>

<span class="sd">        If `analyze` is specified, runs the plan and reports metrics.</span>

<span class="sd">        Args:</span>
<span class="sd">            verbose: If `True`, more details will be included.</span>
<span class="sd">            analyze: If `True`, the plan will run and metrics reported.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame with the explanation of its plan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">analyze</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.logical_plan">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.logical_plan">[docs]</a>
    <span class="k">def</span> <span class="nf">logical_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LogicalPlan</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the unoptimized `LogicalPlan` that comprises this `DataFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Unoptimized logical plan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">logical_plan</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.optimized_logical_plan">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.optimized_logical_plan">[docs]</a>
    <span class="k">def</span> <span class="nf">optimized_logical_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LogicalPlan</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the optimized `LogicalPlan` that comprises this `DataFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optimized logical plan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">optimized_logical_plan</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.execution_plan">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.execution_plan">[docs]</a>
    <span class="k">def</span> <span class="nf">execution_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExecutionPlan</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the execution/physical plan that comprises this `DataFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Execution plan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">execution_plan</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.repartition">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.repartition">[docs]</a>
    <span class="k">def</span> <span class="nf">repartition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Repartition a DataFrame into `num` partitions.</span>

<span class="sd">        The batches allocation uses a round-robin algorithm.</span>

<span class="sd">        Args:</span>
<span class="sd">            num: Number of partitions to repartition the DataFrame into.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Repartitioned DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="n">num</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.repartition_by_hash">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.repartition_by_hash">[docs]</a>
    <span class="k">def</span> <span class="nf">repartition_by_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">exprs</span><span class="p">:</span> <span class="n">Expr</span><span class="p">,</span> <span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Repartition a DataFrame using a hash partitioning scheme.</span>

<span class="sd">        Args:</span>
<span class="sd">            exprs: Expressions to evaluate and perform hashing on.</span>
<span class="sd">            num: Number of partitions to repartition the DataFrame into.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Repartitioned DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">expr</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">exprs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">repartition_by_hash</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.union">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.union">[docs]</a>
    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">distinct</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the union of two `DataFrame`s.</span>

<span class="sd">        The two `DataFrame`s must have exactly the same schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: DataFrame to union with.</span>
<span class="sd">            distinct: If `True`, duplicate rows will be removed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after union.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">distinct</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.union_distinct">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.union_distinct">[docs]</a>
    <span class="k">def</span> <span class="nf">union_distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the distinct union of two `DataFrame`s.</span>

<span class="sd">        The two `DataFrame`s must have exactly the same schema.</span>
<span class="sd">        Any duplicate rows are discarded.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: DataFrame to union with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after union.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">union_distinct</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">df</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.intersect">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.intersect">[docs]</a>
    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the intersection of two `DataFrame`s.</span>

<span class="sd">        The two `DataFrame`s must have exactly the same schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            other:  DataFrame to intersect with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after intersection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">df</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.except_all">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.except_all">[docs]</a>
    <span class="k">def</span> <span class="nf">except_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the exception of two `DataFrame`s.</span>

<span class="sd">        The two `DataFrame`s must have exactly the same schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: DataFrame to calculate exception with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame after exception.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">except_all</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">df</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.write_csv">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.write_csv">[docs]</a>
    <span class="k">def</span> <span class="nf">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">with_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame`  and write the results to a CSV file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path of the CSV file to write.</span>
<span class="sd">            with_header: If true, output the CSV header row.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">with_header</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.write_parquet">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.write_parquet">[docs]</a>
    <span class="k">def</span> <span class="nf">write_parquet</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">compression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uncompressed&quot;</span><span class="p">,</span>
        <span class="n">compression_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and write the results to a Parquet file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path of the Parquet file to write.</span>
<span class="sd">            compression: Compression type to use.</span>
<span class="sd">            compression_level: Compression level to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">compression</span><span class="p">,</span> <span class="n">compression_level</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.write_json">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.write_json">[docs]</a>
    <span class="k">def</span> <span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and write the results to a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path of the JSON file to write.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.to_arrow_table">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.to_arrow_table">[docs]</a>
    <span class="k">def</span> <span class="nf">to_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and convert it into an Arrow Table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Arrow Table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_arrow_table</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.execute_stream">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.execute_stream">[docs]</a>
    <span class="k">def</span> <span class="nf">execute_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecordBatchStream</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes this DataFrame and returns a stream over a single partition.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Record Batch Stream over a single partition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RecordBatchStream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">execute_stream</span><span class="p">())</span></div>


<div class="viewcode-block" id="DataFrame.execute_stream_partitioned">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.execute_stream_partitioned">[docs]</a>
    <span class="k">def</span> <span class="nf">execute_stream_partitioned</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">RecordBatchStream</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes this DataFrame and returns a stream for each partition.</span>

<span class="sd">        Returns:</span>
<span class="sd">            One record batch stream per partition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">streams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">execute_stream_partitioned</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">RecordBatchStream</span><span class="p">(</span><span class="n">rbs</span><span class="p">)</span> <span class="k">for</span> <span class="n">rbs</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">]</span></div>


<div class="viewcode-block" id="DataFrame.to_pandas">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.to_pandas">[docs]</a>
    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and convert it into a Pandas DataFrame.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.to_pylist">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.to_pylist">[docs]</a>
    <span class="k">def</span> <span class="nf">to_pylist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and convert it into a list of dictionaries.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_pylist</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.to_pydict">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.to_pydict">[docs]</a>
    <span class="k">def</span> <span class="nf">to_pydict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and convert it into a dictionary of lists.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of lists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_pydict</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.to_polars">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.to_polars">[docs]</a>
    <span class="k">def</span> <span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the `DataFrame` and convert it into a Polars DataFrame.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Polars DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_polars</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.count">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.count">[docs]</a>
    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total number of rows in this `DataFrame`.</span>

<span class="sd">        Note that this method will actually run a plan to calculate the</span>
<span class="sd">        count, which may be slow for large or complicated DataFrames.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Number of rows in the DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.unnest_column">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.unnest_column">[docs]</a>
    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;Use :func:`unnest_columns` instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">unnest_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">preserve_nulls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;See ``unnest_columns``.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">unnest_column</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">preserve_nulls</span><span class="o">=</span><span class="n">preserve_nulls</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.unnest_columns">
<a class="viewcode-back" href="../../generated/datafusion.DataFrame.html#datafusion.DataFrame.unnest_columns">[docs]</a>
    <span class="k">def</span> <span class="nf">unnest_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">preserve_nulls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Expand columns of arrays into a single row per array element.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column names to perform unnest operation on.</span>
<span class="sd">            preserve_nulls: If False, rows with null entries will not be</span>
<span class="sd">                returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A DataFrame with the columns expanded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">unnest_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">preserve_nulls</span><span class="o">=</span><span class="n">preserve_nulls</span><span class="p">))</span></div>
</div>

</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  
<!-- Based on pydata_sphinx_theme/footer.html -->
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2024, Apache Software Foundation.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.4.7.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p>Apache Arrow DataFusion, Arrow DataFusion, Apache, the Apache feather logo, and the Apache Arrow DataFusion project logo</p>
      <p>are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
    </div>
  </div>
</footer>


  </body>
</html>